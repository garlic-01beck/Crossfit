<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>1RM Percentage & Plate Calculator</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#f7f7fb;
  --panel:#ffffff;
  --text:#0f172a;
  --muted:#64748b;
  --accent:#2563eb;
  --danger:#dc2626;
  --border:#e5e7eb;
  --shadow:0 8px 20px rgba(15,23,42,0.08);
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:Inter,system-ui,Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  font-size:17px;
  line-height:1.45;
}
main{padding:22px 16px 32px; max-width:860px; margin:0 auto;}
header h1{margin:0 0 8px; font-size:1.75rem; letter-spacing:-0.01em;}
header p{margin:0 0 20px; color:var(--muted);} 

.section{background:var(--panel); border:1px solid var(--border); border-radius:16px; padding:18px; box-shadow:var(--shadow);} 
.section + .section{margin-top:16px;}
.section h2{margin:0 0 14px; font-size:1.05rem; color:#111827;}

label{display:block; font-size:0.92rem; color:var(--muted); margin-bottom:8px;}
input,select{
  width:100%;
  padding:14px 14px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#fff;
  color:var(--text);
  font-size:1rem;
}
input:focus,select:focus{outline:2px solid rgba(37,99,235,0.2); border-color:var(--accent);} 

.form-row{display:grid; grid-template-columns:1fr; gap:16px;}

.segmented{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:8px;
}
.segmented input{
  position:absolute;
  opacity:0;
  pointer-events:none;
}
.segmented label{
  margin:0;
  text-align:center;
  padding:12px 10px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#f9fafb;
  color:var(--text);
  font-weight:600;
  cursor:pointer;
  transition:all 0.2s ease;
}
.segmented input:checked + label{
  border-color:var(--accent);
  background:rgba(37,99,235,0.08);
  color:var(--accent);
}

.checkbox-grid{
  display:grid;
  grid-template-columns:repeat(2, minmax(0,1fr));
  gap:10px;
}
.checkbox-item{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  border:1px solid var(--border);
  border-radius:12px;
  background:#f9fafb;
}
.checkbox-item input{
  width:18px;
  height:18px;
  margin:0;
}
.checkbox-item span{
  font-weight:600;
  font-size:0.95rem;
}

.stat{display:flex; justify-content:space-between; gap:12px; padding:10px 0; border-bottom:1px dashed #edf2f7;}
.stat:last-of-type{border-bottom:none;}
.stat span:last-child{font-weight:600;}
.warning{color:var(--danger); font-size:0.95rem; margin-top:10px;}

.plates{display:flex; flex-wrap:wrap; gap:10px; margin-top:12px;}
.plate-chip{padding:8px 12px; border-radius:999px; color:#0b1220; font-weight:600; font-size:0.9rem; box-shadow:0 2px 6px rgba(15,23,42,0.08);} 

.stack{margin-top:12px; border:1px dashed #d1d5db; padding:12px; border-radius:12px; background:#f9fafb;}
.stack-row{display:flex; align-items:center; gap:10px; margin:8px 0;}
.bar{height:20px; border-radius:8px; min-width:24px;}
.count{font-size:0.9rem; color:var(--muted);} 

.footer-note{font-size:0.85rem; color:var(--muted); margin-top:8px;} 

.sticky-results{position:static;}

@media(min-width:720px){
  main{padding:28px;}
  header h1{font-size:1.9rem;}
  .section{padding:20px;}
  .form-row{grid-template-columns:1fr 1fr;}
  .form-row .full{grid-column:1 / -1;}
  .checkbox-grid{grid-template-columns:repeat(4, minmax(0,1fr));}
}

@media(max-width:719px){
  body{font-size:18px;}
  input,select{font-size:1.02rem; padding:16px;}
  .section{padding:16px;}
  .sticky-results{
    position:sticky;
    top:12px;
    z-index:5;
  }
  .sticky-results::before{
    content:"";
    position:absolute;
    inset:-8px -8px -8px -8px;
    border-radius:20px;
    background:linear-gradient(180deg, rgba(247,247,251,0.95), rgba(247,247,251,0.65));
    z-index:-1;
  }
}
</style>
</head>
<body>
<main>
  <header>
    <h1>1RM Percentage & Plate Calculator</h1>
    <p>Calculate percentage targets and barbell plate loading per side.</p>
  </header>

  <section class="section" aria-label="Inputs">
    <h2>Inputs</h2>
    <div class="form-row">
      <div>
        <label for="oneRm">1RM (lbs)</label>
        <input id="oneRm" type="number" min="0" step="1" value="200" inputmode="decimal" />
      </div>
      <div>
        <label for="barWeight">Bar Weight (lbs)</label>
        <select id="barWeight" aria-label="Bar weight">
          <option value="35">35 lb (Default)</option>
          <option value="45">45 lb</option>
        </select>
      </div>
      <div class="full">
        <label for="percentSelect">Select Percentage</label>
        <select id="percentSelect"></select>
      </div>
      <div class="full">
        <label>Plate Availability</label>
        <div class="segmented" role="radiogroup" aria-label="Plate availability">
          <input type="radio" id="modeGym" name="plateMode" value="gym" checked>
          <label for="modeGym">Gym</label>
          <input type="radio" id="modeHome" name="plateMode" value="home">
          <label for="modeHome">Home</label>
        </div>
      </div>
      <div id="homePlates" class="full" hidden>
        <label>Select Plates You Have</label>
        <div class="checkbox-grid" id="plateCheckboxes"></div>
      </div>
    </div>
  </section>

  <section class="section sticky-results" aria-label="Selected Result">
    <h2>Selected Target</h2>
    <div class="stat"><span>Selected Percentage</span><span id="selPercent">—</span></div>
    <div class="stat"><span>Exact Target</span><span id="exactTarget">—</span></div>
    <div class="stat"><span>Rounded Target</span><span id="roundedTarget">—</span></div>
    <div class="stat"><span>Per Side Load</span><span id="perSide">—</span></div>
    <div id="warning" class="warning" role="alert"></div>

    <h2 style="margin-top:20px;">Plate Breakdown (per side)</h2>
    <div id="plateList" class="plates"></div>
    <div id="stack" class="stack"></div>

    <p class="footer-note">Rounding to nearest 5 lb total (2.5 lb per side).</p>
  </section>
</main>

<script>
(function(){
  const plateData = [
    {w:55,color:'#7f1d1d',label:'55 lb'},
    {w:45,color:'#2563eb',label:'45 lb'},
    {w:35,color:'#facc15',label:'35 lb',text:'#0b1220'},
    {w:25,color:'#22c55e',label:'25 lb'},
    {w:15,color:'#6b7280',label:'15 lb'},
    {w:10,color:'#f8fafc',label:'10 lb',text:'#0b1220'},
    {w:5,color:'#3b82f6',label:'5 lb'},
    {w:2.5,color:'#10b981',label:'2.5 lb'}
  ];

  const oneRmEl = document.getElementById('oneRm');
  const barEl = document.getElementById('barWeight');
  const percentSelect = document.getElementById('percentSelect');
  const selPercent = document.getElementById('selPercent');
  const exactTarget = document.getElementById('exactTarget');
  const roundedTarget = document.getElementById('roundedTarget');
  const perSide = document.getElementById('perSide');
  const warning = document.getElementById('warning');
  const plateList = document.getElementById('plateList');
  const stack = document.getElementById('stack');
  const modeGym = document.getElementById('modeGym');
  const modeHome = document.getElementById('modeHome');
  const homePlates = document.getElementById('homePlates');
  const plateCheckboxes = document.getElementById('plateCheckboxes');

  function formatWeight(w){
    return `${w.toFixed(1).replace(/\\.0$/,'')} lb`;
  }

  function roundToNearest5(w){
    return Math.round(w/5)*5;
  }

  function buildPercentOptions(){
    percentSelect.innerHTML='';
    for(let p=5;p<=100;p+=5){
      const opt=document.createElement('option');
      opt.value=p;
      opt.textContent=`${p}%`;
      percentSelect.appendChild(opt);
    }
  }

  function buildPlateCheckboxes(){
    plateCheckboxes.innerHTML='';
    plateData.forEach((plate)=>{
      const id = `plate-${plate.w}`.replace('.','-');
      const wrapper = document.createElement('label');
      wrapper.className = 'checkbox-item';
      wrapper.setAttribute('for', id);

      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.id = id;
      checkbox.value = plate.w;
      checkbox.checked = true;
      checkbox.addEventListener('change', updateAll);

      const text = document.createElement('span');
      text.textContent = plate.label;

      wrapper.appendChild(checkbox);
      wrapper.appendChild(text);
      plateCheckboxes.appendChild(wrapper);
    });
  }

  function getInputs(){
    const oneRm = parseFloat(oneRmEl.value);
    const bar = parseFloat(barEl.value);
    return {oneRm: isNaN(oneRm)?0:oneRm, bar: isNaN(bar)?35:bar};
  }

  function getAvailablePlates(){
    if(modeGym.checked){
      return plateData;
    }
    const selected = new Set();
    plateCheckboxes.querySelectorAll('input[type="checkbox"]').forEach(cb=>{
      if(cb.checked){
        selected.add(parseFloat(cb.value));
      }
    });
    return plateData.filter(p=>selected.has(p.w));
  }

  function calcPlates(perSideLoad, availablePlates){
    const plates=[];
    let remaining=perSideLoad;
    for(const p of availablePlates){
      const count=Math.floor(remaining / p.w + 1e-9);
      if(count>0){
        plates.push({plate:p, count});
        remaining -= count * p.w;
      }
    }
    return {plates, remaining};
  }

  function renderPlates(plates){
    plateList.innerHTML='';
    stack.innerHTML='';
    if(plates.length===0){
      plateList.textContent='No plates needed.';
      return;
    }
    plates.forEach(item=>{
      const chip=document.createElement('div');
      chip.className='plate-chip';
      chip.textContent=`${item.plate.label} × ${item.count}`;
      chip.style.background=item.plate.color;
      if(item.plate.text) chip.style.color=item.plate.text;
      plateList.appendChild(chip);

      const row=document.createElement('div');
      row.className='stack-row';
      const bar=document.createElement('div');
      bar.className='bar';
      bar.style.background=item.plate.color;
      bar.style.width=`${Math.max(32, item.plate.w*1.9)}px`;
      if(item.plate.text) bar.style.color=item.plate.text;
      const label=document.createElement('span');
      label.className='count';
      label.textContent=`${item.count} × ${item.plate.label}`;
      row.appendChild(bar);
      row.appendChild(label);
      stack.appendChild(row);
    });
  }

  function updateModeUI(){
    homePlates.hidden = !modeHome.checked;
  }

  function updateAll(){
    const {oneRm, bar} = getInputs();
    const percent = parseFloat(percentSelect.value);
    const exact = oneRm * percent / 100;
    const rounded = roundToNearest5(exact);
    const load = rounded - bar;
    warning.textContent='';

    selPercent.textContent = `${percent}%`;
    exactTarget.textContent = formatWeight(exact);
    roundedTarget.textContent = formatWeight(rounded);

    if(load < 0){
      perSide.textContent = '—';
      plateList.innerHTML='';
      stack.innerHTML='';
      warning.textContent = 'Target weight is below bar weight.';
      return;
    }

    const per = load/2;
    perSide.textContent = formatWeight(per);

    const availablePlates = getAvailablePlates();
    const {plates, remaining} = calcPlates(per, availablePlates);
    renderPlates(plates);
    if(remaining > 0.01){
      warning.textContent = `Cannot match exactly. Remainder: ${remaining.toFixed(2)} lb per side.`;
    }
  }

  function init(){
    buildPercentOptions();
    buildPlateCheckboxes();
    percentSelect.value = '70';
    barEl.value = '35';
    updateModeUI();
    updateAll();
  }

  [oneRmEl, barEl, percentSelect, modeGym, modeHome].forEach(el=>{
    el.addEventListener('input', () => {
      updateModeUI();
      updateAll();
    });
    el.addEventListener('change', () => {
      updateModeUI();
      updateAll();
    });
  });

  init();
})();
</script>
</body>
</html>
